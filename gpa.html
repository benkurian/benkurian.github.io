<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olentangy GPA Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            .transcript-container, .transcript-container * {
                visibility: visible;
            }
            .transcript-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
            }
            .no-print {
                display: none !important;
            }
            .course-list {
                page-break-inside: avoid;
            }
        }
        .course-card {
            cursor: move;
            transition: all 0.3s;
            margin-bottom: 1rem;
        }
        .course-card.dragging {
            opacity: 0.5;
            border: 2px dashed var(--bs-primary);
        }
        .year-divider {
            background-color: #f8f9fa;
            border-left: 4px solid var(--bs-primary);
            padding: 10px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        .year-divider.collapsed {
            opacity: 0.8;
            background-color: #e9ecef;
        }
        .form-check-input:checked + .form-check-label {
            opacity: 1;
        }
        .form-check-input:not(:checked) + .form-check-label {
            opacity: 0.5;
        }
        .alert-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
            min-width: 350px;
        }
        .btn-action {
            min-width: 120px;
        }
        .modal-dialog-centered {
            display: flex;
            align-items: center;
            min-height: calc(100% - 1rem);
        }
        .year-header {
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.25rem;
        }
        .year-header:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        .year-courses {
            transition: all 0.3s ease;
            overflow: hidden;
        }
        .gpa-badge {
            font-size: 2.5rem;
            padding: 1rem 2rem;
            border-radius: 1rem;
        }
        .empty-state {
            text-align: center;
            padding: 3rem;
            background-color: #f8f9fa;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
        }
        .course-actions {
            display: flex;
            gap: 0.5rem;
        }
        .btn-undo-redo {
            min-width: 80px;
        }
        @media (max-width: 768px) {
            .course-card .row > div {
                margin-bottom: 10px;
            }
            .course-card .btn {
                margin-top: 0 !important;
            }
            .course-actions {
                flex-direction: column;
            }
            .gpa-badge {
                font-size: 1.75rem;
                padding: 0.75rem 1.5rem;
            }
            .btn-undo-redo {
                min-width: 60px;
            }
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-4">
        <!-- Alert Toast Container -->
        <div id="alertToast" class="alert-toast"></div>
        
        <!-- Export Modal -->
        <div class="modal fade" id="exportModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Export GPA Data</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="exportFileName" class="form-label">File Name:</label>
                            <input type="text" class="form-control" id="exportFileName" value="My GPA">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" onclick="performExport()">Export</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Clear All Modal -->
        <div class="modal fade" id="clearAllModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Confirm Action</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure you want to remove all courses and terms? This action cannot be undone.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" onclick="performClearAll()">Remove All</button>
                    </div>
                </div>
            </div>
        </div>
       
         <!-- Custom Term Modal -->
<div class="modal fade" id="customTermModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Custom Term</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="customTermName" class="form-label">Term Name:</label>
                    <input type="text" class="form-control" id="customTermName" placeholder="e.g., 2024-2025">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addCustomTerm()">Add Term</button>
            </div>
        </div>
    </div>
</div>
       
        <!-- Remove Year Modal -->
        <div class="modal fade" id="removeYearModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="removeYearModalTitle">Confirm Action</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="removeYearModalBody">
                        <p>Are you sure you want to remove this term and all its courses?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" onclick="performRemoveYear()">Remove Term</button>
                    </div>
                </div>
            </div>
        </div>
        
        <h1 class="text-center mb-4">Olentangy GPA Calculator</h1>
        
        <!-- Year Selection -->
            <div class="row mb-3">
                <div class="col-md-6 mx-auto">
                    <div class="input-group">
                        <span class="input-group-text">Term</span>
                        <select class="form-select" id="year-select">
                            <!-- Years will be populated dynamically -->
                        </select>
                        <button class="btn btn-primary" type="button" onclick="addYearDivider()">
                            <i class="bi bi-plus-circle"></i> Add Term
                        </button>
                        <button class="btn btn-outline-secondary" type="button" onclick="showCustomTermModal()">
                            <i class="bi bi-pencil-square"></i> Custom
                        </button>
                    </div>
                </div>
            </div>

        <!-- Course Container -->
        <div id="course-container" class="mb-4">
            <div class="empty-state">
                <h3>No courses added yet</h3>
                <p class="text-muted">Start by adding a term</p>
                <button class="btn btn-primary mt-2" onclick="addYearDivider()">
                    <i class="bi bi-plus-circle"></i> Add Term
                </button>
            </div>
        </div>
        
        <!-- Action Buttons -->
<div class="text-center mb-4">
    <div class="btn-toolbar justify-content-center" role="toolbar" aria-label="Toolbar with button groups">
        <!-- Add & Remove Group -->
        <div class="btn-group me-3 mb-2" role="group" aria-label="Add and Remove Group">
            <button class="btn btn-outline-primary" onclick="addCourse()" data-bs-toggle="tooltip" data-bs-placement="top" title="Add a new course to the most recent term">
                <i class="bi bi-plus-circle"></i> Add Course
            </button>
            <button class="btn btn-outline-danger" onclick="showClearAllModal()" data-bs-toggle="tooltip" data-bs-placement="top" title="Remove all courses and terms">
                <i class="bi bi-trash"></i> Remove All
            </button>
        </div>
        <!-- Export & Import Group -->
        <div class="btn-group me-3 mb-2" role="group" aria-label="Export and Import Group">
            <button class="btn btn-outline-primary" onclick="showExportModal()" data-bs-toggle="tooltip" data-bs-placement="top" title="Export GPA data to a JSON file">
                <i class="bi bi-download"></i> Export
            </button>
            <input type="file" id="jsonFileInput" accept="application/json" onchange="importFromJSON(event)" style="display: none;">
            <button class="btn btn-outline-primary" onclick="document.getElementById('jsonFileInput').click()" data-bs-toggle="tooltip" data-bs-placement="top" title="Import GPA data from a JSON file">
                <i class="bi bi-upload"></i> Import
            </button>
        </div>
        <!-- Undo & Redo Group -->
        <div class="btn-group me-3 mb-2" role="group" aria-label="Undo and Redo Group">
            <button class="btn btn-outline-secondary" id="undoBtn" onclick="undoAction()" data-bs-toggle="tooltip" data-bs-placement="top" title="Undo last action" disabled>
                <i class="bi bi-arrow-counterclockwise"></i> Undo
            </button>
            <button class="btn btn-outline-secondary" id="redoBtn" onclick="redoAction()" data-bs-toggle="tooltip" data-bs-placement="top" title="Redo last undone action" disabled>
                <i class="bi bi-arrow-clockwise"></i> Redo
            </button>
        </div>
        <!-- Print Report -->
        <div class="btn-group mb-2" role="group" aria-label="Print Report">
            <button class="btn btn-outline-dark" onclick="generateTranscript()">
                <i class="bi bi-file-earmark-pdf"></i> Print Report
            </button>
        </div>
    </div>
</div>
        <!-- GPA Results -->
        <div class="row mt-4">
            <div class="col-md-6 mb-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h4 class="card-title">Weighted GPA</h4>
                        <h2 class="display-4"><span id="gpa-result" class="badge bg-primary gpa-badge">0.000</span></h2>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h4 class="card-title">Unweighted GPA</h4>
                        <h2 class="display-4"><span id="unweighted-gpa-result" class="badge bg-secondary gpa-badge">0.000</span></h2>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Custom Scripts -->
    <script src="/assets/data/gpa.js"></script>
    <!-- Bootstrap JS -->  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>